#  **Android** 获取系统开机时间

## 通过系统SystemClock借口运算

`android.os.SystemClock的elapsedRealtimeNanos`返回从系统开机到现在的经历过的时间，包括系统休眠待机时间。所以我们可以使用当前时间减去系统开机到现在的时间计算出系统的启动时间。

``` java
// 返回开机时间，单位微妙
long bootTime() {
    return System.currentTimeMillis() - SystemClock.elapsedRealtime();
}
```

> 必须在Android 4.2以上才能支持该接口，在低版本上调用会因为无法找到方法而闪退!

## 通过读取`/proc/stat`文件获取系统开机时间

**关于 /proc/stat文件：** stat文件记录了当前系统常有状态，例如cpu时钟，内存页，开机时间等等。其中开机时间是btime字段后面的数值单位是秒。

手机设备的 /proc/stat内容（华为， Android6.0系统）:

``` shell
shell@HWGRA:/proc $ cat stat
cpu  1840729 131539 1145597 10753491 13057 57 45011 0 0 0
cpu0 246543 17369 249206 7219225 3792 11 32119 0 0 0
cpu1 282309 19254 210287 545809 2092 39 4639 0 0 0
cpu2 279958 19834 209812 547156 2380 3 2743 0 0 0
cpu3 276153 20196 203136 548855 2257 4 1970 0 0 0
cpu4 173666 14209 67996 502766 1131 0 1414 0 0 0
cpu5 205458 13675 70375 448196 528 0 703 0 0 0
cpu6 210211 13822 70829 449078 430 0 710 0 0 0
cpu7 166431 13180 63956 492406 447 0 713 0 0 0
intr 164085213 0 0 0 0 341 0 0 0 167 167 0 0 0 4 3 0 0 0 0 0 0 0 0 0 0 0 0 19263077 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 50348 0 0 0 0 0 0 6615253 0 0 0 0 0 0 68541 0 0 620 0 0 0 0 3304 0 0 0 0 0 0 0 0 177234 26390930 24 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 53695 0 0 32981493 9285925 2391853 2011 0 0 0 0 0 0 0 0 0 485 0 0 0 0 0 1480860 100 2118249 0 0 0 0 5 998345 0 196 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 991829 51562 0 0 0 131664 0 918 0 429104 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 69486 31005 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 4 1 21 0 0 0 0 0 0 286338 0 0 0 8 1 0 143155 1
ctxt 197939068
btime 1501803547
processes 238588
procs_running 2
procs_blocked 0
softirq 78287404 12496 14322913 16214 439295 11578 11578 45998374 3558439 4601 13911916
```

可以看到btime字段 :
        `btime 1501803547`

表示从1970-01-01 00:00:00 +0000起始的时间，单位：秒

## 总结

虽然使用stat文件也能够获取开机时间，但是精度只能到达秒，还是没有系统SystemClock.elapsedRealtimeNanos的精度搞。因此我们折中处理，在android4.2高版本使用系统API接口，低版本使用stat数值接口，即保证兼容性又能够发挥高版本的精度问题。